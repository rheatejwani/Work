---
title: "Spotify Music Project"
author: "RiSK: Rhea Tejwani, Sue Zhang, Keena Gao"
date: "10/25/20"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE, 
                      message = FALSE)
```

Your written report goes here! Before you submit, make sure your code chunks are turned off with `echo = FALSE` and there are no warnings or messages with `warning = FALSE` and `message = FALSE` 

#Introduction
  The dataset contains statistics of the most popular music in the world over the years on the streaming service Spotify. Music is constantly changing, and as students who frequently listen to music, we want to analyze the trends of popular music in our generation and the generations before us. Our research question is “how have characteristics of the most listened to music changed over time?” Our hypotheses are that popular music has shifted to be more diverse in these categories like acoustics, BPM, valence, etc.
  This data set has 15 columns and 1994 rows. The observations in the data set describe the characteristics of the top 2000 most popular songs from 1956 to 2019 from Spotify. Title: title of the song Artist: the musician/group who performed the song Top genre: genre of the track year: year it was released Beats per minute(bpm): tempo of the song Energy: how energetic the song is Danceability: how easy the song is to dance to Loudness(dB): how loud the song is Liveness: the likeliness of the song being a live recording Valence: how positive a song is Length(duration): the length of a track Acousticness: how acoustic a song is Speechiness: how much spoken word is in the song Popularity: how popular a song is The original data set was taken from the playlist on spotify Top 2000s on PlaylistMachinery(@plamere) using Selenium with Python. It was scraped from http://sortyourmusic.playlistmachinery.com/.

# Methodology

  We will look at the correlation, variance and IQR of the variables for beats per minute, energy, valence, acousticness and speechiness. We will visualize our data using ggplot with scatterplots, boxplots and histograms. We will try to use linear models and the tools from library(broom). We can use summary statistics to find the mean, median and range of our data. We will also use the library(tidyverse) functions to explore our data set. We will find the p-value and use hypothesis tests to analyze the statistical significance of our tests.
  
#Data
```{r load-packages-and-data}
library(tidyverse)
library(infer)
spotify_data <- read_csv("data/Spotify-2000.csv")
```

```{r decade-variable}
spotify_data <- spotify_data %>%
  mutate(decade = case_when(Year <= 1959 ~ " 50s",
                            Year >=1960 & Year <=1969 ~ " 60s",
                            Year >=1970 & Year <=1979 ~ " 70s",
                            Year >=1980 & Year <=1989 ~ " 80s",
                            Year >=1990 & Year <=1999 ~ " 90s",
                            Year >=2000 & Year <=2009 ~ "2000s",
                            Year >=2010 & Year <= 2021 ~ "2010s",))
```

```{r bpm-boxplot}
  ggplot(data=spotify_data, mapping=aes(x=decade, y=`Beats Per Minute (BPM)`, fill=decade)) +
         geom_boxplot() +
  labs(title="BPM vs. Decade")
```

```{r valence-boxplot}
  ggplot(data=spotify_data, mapping=aes(x=decade, y=Valence, fill=decade)) +
         geom_boxplot() +
  labs(title="Valence vs. Decade")
```

```{r speechiness-boxplot}
  ggplot(data=spotify_data, mapping=aes(x=decade, y=Speechiness, fill=decade)) +
         geom_boxplot() +
  labs(title="Speechiness vs. Decade")
```

```{r past-present-variable}
spotify_data <- spotify_data %>%
  mutate(period = case_when(Year <= 1959 ~ "Oldies",
                            Year >=1960 & Year <=1969 ~ "Oldies",
                            Year >=1970 & Year <=1979 ~ "Oldies",
                            Year >=1980 & Year <=1989 ~ "Oldies",
                            Year >=1990 & Year <=1999 ~ "Present",
                            Year >=2000 & Year <=2009 ~ "Present",
                            Year >=2010 & Year <= 2021 ~ "Present",))
```

```{r oldies-variance}
spotify_data %>%
  filter(period=="Oldies") %>%
  summarise(variance = var(Acousticness))
```

```{r present-variance}
spotify_data %>%
  filter(period=="Present") %>%
  summarise(variance = var(Acousticness))
```


#we are confused as to how to use simulation with our dataset, so we would appreciate help/advice on how to do this please! :)